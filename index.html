<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>The Agentic Symphony | Faramarz Kowsari</title>
    
    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Noto+Sans+Arabic:wght@300;400;700;900&family=Playfair+Display:ital,wght@0,600;0,800;1,600&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #2563eb;
            --glass: rgba(255, 255, 255, 0.98);
        }

        body { font-family: 'Inter', sans-serif; background: #f8fafc; overflow-x: hidden; }
        
        /* Typography & RTL */
        .serif { font-family: 'Playfair Display', serif; }
        .fa-font { font-family: 'Noto Sans Arabic', sans-serif; }
        
        .rtl { direction: rtl; }
        .rtl .flip-icon { transform: scaleX(-1); }
        .rtl .text-justify { text-align: justify; }

        /* Mini Player Style - Optimized for Mobile */
        .mini-audio-widget {
            position: fixed;
            bottom: 24px;
            right: 20px;
            z-index: 999; /* تضمین نمایش روی تمامی المان‌ها در موبایل */
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 50px;
            padding: 10px 18px;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
            max-width: 85vw;
        }
        
        .lang-fa .mini-audio-widget { right: auto; left: 20px; flex-direction: row-reverse; }

        /* Scroll Area Padding */
        .safe-bottom { padding-bottom: 100px; }

        /* Animations */
        .fade-in { animation: fadeIn 0.5s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* Sidebar scroll area */
        .sidebar-scroll { height: calc(100vh - 400px); overflow-y: auto; }
        
        /* Custom UI */
        .download-bar {
            background: #1e293b;
            color: white;
        }
        
        .book-p { margin-bottom: 1.5rem; line-height: 2.1; }
    </style>
</head>
<body class="antialiased text-slate-800">

    <!-- TOP DOWNLOAD BAR -->
    <div class="download-bar w-full py-3 px-6 flex flex-wrap justify-center gap-4 sticky top-0 z-50 shadow-md">
        <span class="text-xs font-bold uppercase tracking-widest hidden sm:inline-flex items-center opacity-70">Download FULL PDF:</span>
        <a id="dl-en" href="pdf/The Agentic Symphony -English.pdf" target="_blank" class="bg-blue-600 hover:bg-blue-500 text-[10px] font-extrabold px-4 py-1.5 rounded-full transition-all flex items-center gap-2">
            <i class="fas fa-file-pdf"></i> ENGLISH
        </a>
        <a id="dl-tr" href="pdf/The Agentic Symphony -Turkish.pdf" target="_blank" class="bg-red-600 hover:bg-red-500 text-[10px] font-extrabold px-4 py-1.5 rounded-full transition-all flex items-center gap-2">
            <i class="fas fa-file-pdf"></i> TÜRKÇE
        </a>
        <a id="dl-fa" href="pdf/The Agentic Symphony -Persian.pdf" target="_blank" class="bg-emerald-600 hover:bg-emerald-500 text-[10px] font-extrabold px-4 py-1.5 rounded-full transition-all flex items-center gap-2 fa-font">
            <i class="fas fa-file-pdf"></i> فارسی
        </a>
    </div>

    <div class="flex h-screen">
        
        <!-- SIDEBAR -->
        <aside id="sidebar" class="fixed md:relative z-50 w-72 h-full bg-white border-r border-slate-200 flex flex-col transform -translate-x-full md:translate-x-0 transition-transform duration-300 shadow-2xl md:shadow-none overflow-hidden">
            
            <!-- Author Profile -->
            <div class="p-6 flex flex-col items-center bg-white relative border-b border-slate-100">
                <button onclick="ui.toggleSidebar()" class="md:hidden absolute top-4 right-4 text-slate-400"><i class="fas fa-times"></i></button>
                
                <!-- Dynamic Cover -->
                <div class="w-32 h-44 mb-4 shadow-xl rounded-md overflow-hidden bg-slate-100 relative">
                    <img id="cover-img" src="images/coverenglish.png" class="w-full h-full object-cover transition-opacity duration-500" alt="Book Cover">
                </div>

                <h1 class="text-md font-extrabold text-slate-900 serif text-center">Faramarz Kowsari</h1>
                <p class="text-[9px] font-bold text-blue-600 uppercase tracking-widest mt-1 text-center">Strategic AI Architect</p>
                
                <div class="flex space-x-4 mt-4 text-slate-400">
                    <a href="mailto:info@faramarzkowsari.com" class="hover:text-blue-600 transition" title="Email Author"><i class="fas fa-envelope text-lg"></i></a>
                    <a href="https://www.linkedin.com/in/faramarzkowsari" target="_blank" class="hover:text-blue-700 transition"><i class="fab fa-linkedin text-lg"></i></a>
                    <a href="https://play.google.com/store/search?q=Faramarz_Kowsari&c=books" target="_blank" class="hover:text-green-600 transition"><i class="fab fa-google-play text-lg"></i></a>
                </div>
            </div>

            <!-- Language Switcher -->
            <div class="p-3 border-b border-slate-100 bg-slate-50 flex gap-2">
                <button onclick="app.setLang('en')" id="btn-en" class="flex-1 py-1.5 text-[10px] font-bold rounded transition-all">ENG</button>
                <button onclick="app.setLang('tr')" id="btn-tr" class="flex-1 py-1.5 text-[10px] font-bold rounded transition-all">TUR</button>
                <button onclick="app.setLang('fa')" id="btn-fa" class="flex-1 py-1.5 text-[10px] font-bold rounded transition-all fa-font">فا</button>
            </div>

            <!-- TOC -->
            <div class="flex-1 p-4 sidebar-scroll custom-scrollbar">
                <h3 id="toc-header" class="text-[9px] font-bold text-slate-400 uppercase tracking-widest mb-3 px-2">Table of Contents</h3>
                <div id="chapter-list" class="space-y-1"></div>
            </div>

            <!-- Footer Meta -->
            <div class="p-4 text-[9px] text-slate-400 text-center uppercase tracking-widest border-t border-slate-50">
                &copy; 2026 Strategic Intelligence
            </div>
        </aside>

        <!-- MAIN CONTAINER -->
        <main id="main-container" class="flex-1 overflow-y-auto bg-white relative w-full scroll-smooth">
            <!-- Mobile Menu Toggle Floating -->
            <button onclick="ui.toggleSidebar()" class="md:hidden fixed bottom-6 left-6 z-50 bg-white shadow-xl w-12 h-12 rounded-full border border-slate-200 text-slate-600">
                <i class="fas fa-bars"></i>
            </button>

            <div class="max-w-4xl mx-auto px-6 py-8 md:py-16 safe-bottom">
                
                <!-- Content Header -->
                <div id="content-header" class="mb-10 border-b border-slate-100 pb-8 fade-in">
                    <div id="chapter-meta" class="flex items-center space-x-2 mb-3 text-blue-600 flip-icon">
                        <span class="w-8 h-0.5 bg-blue-600"></span>
                        <span id="chapter-num" class="text-xs font-bold uppercase tracking-widest">Chapter 1</span>
                    </div>
                    <h2 id="chapter-title" class="text-4xl md:text-5xl font-extrabold text-slate-900 serif leading-tight">The Genesis of Agency</h2>
                </div>

                <!-- Book Content -->
                <article id="text-body" class="text-lg text-slate-700 space-y-2 fade-in text-justify">
                    <!-- Text generated by JS Engine -->
                </article>

                <!-- Navigation -->
                <div class="mt-16 pt-8 border-t border-slate-100 flex justify-between items-center fade-in">
                    <button onclick="app.nav(-1)" id="prev-btn" class="flex items-center px-4 py-2 rounded-lg text-slate-400 hover:text-blue-600 disabled:opacity-30 transition">
                        <i class="fas fa-arrow-left mr-2 flip-icon"></i>
                        <span id="prev-text" class="text-xs font-bold uppercase">Prev</span>
                    </button>
                    <button onclick="app.nav(1)" id="next-btn" class="flex items-center px-4 py-2 rounded-lg text-slate-400 hover:text-blue-600 disabled:opacity-30 transition">
                        <span id="next-text" class="text-xs font-bold uppercase">Next</span>
                        <i class="fas fa-arrow-right ml-2 flip-icon"></i>
                    </button>
                </div>
            </div>
        </main>
    </div>

    <!-- MINI PLAYER WIDGET -->
    <div id="audio-player" class="mini-audio-widget hidden">
        <div class="flex items-center gap-3 border-r pr-3 border-slate-200 rtl:border-r-0 rtl:border-l rtl:pl-3">
            <button onclick="audio.toggle()" id="play-btn" class="w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center hover:bg-blue-700 transition">
                <i class="fas fa-play ml-0.5"></i>
            </button>
            <button onclick="audio.stop()" class="text-slate-400 hover:text-red-500"><i class="fas fa-stop text-xs"></i></button>
        </div>
        <div class="flex flex-col">
            <span id="audio-status" class="text-[9px] font-bold text-slate-500 uppercase tracking-tighter">Listen Chapter</span>
            <div class="flex items-center gap-4">
                <button onclick="audio.speed()" id="speed-btn" class="text-[10px] font-extrabold text-blue-600">1x</button>
                <div class="w-24 bg-slate-100 h-1 rounded-full overflow-hidden">
                    <div id="audio-progress" class="bg-blue-500 h-full w-0 transition-all"></div>
                </div>
            </div>
        </div>
        <button onclick="audio.hide()" class="ml-2 text-slate-300 hover:text-slate-500"><i class="fas fa-times-circle"></i></button>
    </div>

    <!-- LOGIC -->
    <script>
        const db = {
            en: {
                cover: "images/coverenglish.png",
                ui: { toc: "Chapters", dl: "Download", prev: "Prev", next: "Next" },
                titles: ["The Genesis of Agency", "Architectures of Coordination", "Semantic Protocols", "Strategic Decomposition", "The Cognitive Loop", "Collaborative Reasoning", "The Human Maestro", "Security in the Ensemble", "Generative Aesthetics", "Edge Agency", "The Post-Programming Era"],
                filler: "The evolution from static commands to agentic intent is a fundamental shift in our civilization. We are orchestrating digital symfonties where specialized agents perform as expert musicians. This transformation liberates human creativity from technical repetition. The maestro's role is to define the goal while the machine manages the execution. Every agent in the orchestra brings a unique expertise to the ensemble. We are building a future where intelligence is collaborative and adaptive. This shift requires new protocols of communication and coordination. Resilience is achieved through decentralized decision making. The cognitive loop allows for continuous learning and alignment. Strategic AI is the cornerstone of national technological sovereignty."
            },
            tr: {
                cover: "images/coverturkish.png",
                ui: { toc: "Bölümler", dl: "İndir", prev: "Geri", next: "İleri" },
                titles: ["Ajanlığın Doğuşu", "Koordinasyon Mimarileri", "Anlamsal Protokoller", "Stratejik Ayrıştırma", "Bilişsel Döngü", "İşbirlikçi Akıl Yürütme", "İnsan Maestro", "Topluluk Güvenliği", "Üretken Estetik", "Uç Nokta Ajanlığı", "Programlama Sonrası"],
                filler: "Statik komutlardan ajan niyetine geçiş tıp kı bir orkestra şefinin yönetimine benzer. Her ajan kendi uzmanlık alanında bir virtüöz gibi hareket eder. Bu süreç insan zekasını mekanik görevlerden özgürleştirir. Maestro hedefi belirlerken makine yürütmeyi yönetir. Orkestradaki her ajan topluluğa benzersiz bir uzmanlık getirir. Zekanın işbirlikçi ve uyarlanabilir olduğu bir gelecek inşa ediyoruz. Bu değişim yeni iletişim ve koordinasyon protokolleri gerektirir. Dayanıklılık merkezi olmayan karar verme yoluyla sağlanır. Bilişsel döngü sürekli öğrenme ve hizalamaya izin verir. Stratejik yapay zeka ulusal teknolojik egemenliğin temel taşıdır."
            },
            fa: {
                cover: "images/coverpersian.png",
                ui: { toc: "فهرست مطالب", dl: "دانلود", prev: "قبلی", next: "بعدی" },
                titles: ["پیدایش عاملیت", "معماری‌های هماهنگی", "پروتکل‌های معنایی", "تجزیه استراتژیک", "حلقه شناختی", "استدلال مشارکتی", "رهبر ارکستر انسانی", "امنیت در گروه", "زیبایی‌شناسی مولد", "عاملیت لبه", "عصر پسابرنامه‌نویسی"],
                filler: "گذار از دستورات ایستا به قصد عاملی تغییری بنیادین در درک ما از هوش است. ما در حال ارکستره کردن سمفونی‌هایی هستیم که در آن هر عامل به عنوان یک نوازنده متخصص عمل می‌کند. این آغاز رهایی خلاقیت انسان از تکرارهای فنی است. نقش رهبر ارکستر تعیین هدف است در حالی که ماشین اجرا را مدیریت می‌کند. هر عامل در ارکستر تخصص منحصر به فردی را به گروه می‌آورد. ما در حال ساخت آینده‌ای هستیم که در آن هوش مشارکتی و تطبیق‌پذیر است. این تغییر نیازمند پروتکل‌های جدید ارتباطی و هماهنگی است. تاب‌آوری از طریق تصمیم‌گیری غیرمتمرکز حاصل می‌شود. حلقه شناختی اجازه یادگیری و تراز مداوم را می‌دهد. هوش مصنوعی استراتژیک سنگ‌بنای حاکمیت تکنولوژیک ملی است."
            }
        };

        const app = {
            lang: 'en',
            idx: 0,
            init: function() {
                this.setLang('en');
                audio.init();
            },
            setLang: function(l) {
                this.lang = l;
                const d = db[l];
                const isRTL = l === 'fa';
                
                document.body.dir = isRTL ? 'rtl' : 'ltr';
                document.body.classList.toggle('rtl', isRTL);
                document.body.classList.toggle('lang-fa', isRTL);
                
                // Sidebar UI
                document.getElementById('sidebar').classList.toggle('text-right', isRTL);
                document.getElementById('toc-header').innerText = d.ui.toc;
                document.getElementById('prev-text').innerText = d.ui.prev;
                document.getElementById('next-text').innerText = d.ui.next;
                
                // Chapter Meta alignment
                const meta = document.getElementById('chapter-meta');
                meta.classList.toggle('space-x-reverse', isRTL);
                
                // Cover Image (From /images as requested)
                const cImg = document.getElementById('cover-img');
                cImg.style.opacity = 0;
                setTimeout(() => { cImg.src = d.cover; cImg.style.opacity = 1; }, 200);

                // Buttons
                ['en', 'tr', 'fa'].forEach(k => {
                    const btn = document.getElementById(`btn-${k}`);
                    btn.className = k === l ? 'flex-1 py-1.5 text-[10px] font-bold rounded bg-blue-600 text-white shadow-sm' : 'flex-1 py-1.5 text-[10px] font-bold rounded text-slate-500 hover:bg-slate-100';
                });

                this.render();
                this.renderTOC();
                
                if(l === 'fa') audio.hide();
                else audio.showWidget();
            },
            render: function() {
                const d = db[this.lang];
                const title = d.titles[this.idx];
                
                // Chapter Number
                const numEl = document.getElementById('chapter-num');
                if (this.lang === 'fa') numEl.innerText = `${this.idx + 1}`;
                else numEl.innerText = (this.lang === 'tr' ? 'Bölüm ' : 'Chapter ') + (this.idx + 1);

                document.getElementById('chapter-title').innerText = title;
                
                // FULL TEXT GENERATION (11 chapters, 5 paragraphs, 10 sentences each)
                let html = "";
                for(let i=0; i<5; i++) {
                    let pContent = `<strong>Part ${i+1}:</strong> `;
                    for(let j=0; j<10; j++) {
                        pContent += d.filler + " ";
                    }
                    html += `<p class="book-p">${pContent}</p>`;
                }
                document.getElementById('text-body').innerHTML = html;

                // Nav State
                document.getElementById('prev-btn').disabled = this.idx === 0;
                document.getElementById('next-btn').disabled = this.idx === 10;
                
                document.getElementById('main-container').scrollTo({top:0, behavior: 'auto'});
                audio.stop();
            },
            renderTOC: function() {
                const list = document.getElementById('chapter-list');
                list.innerHTML = '';
                db[this.lang].titles.forEach((t, i) => {
                    const btn = document.createElement('button');
                    const active = i === this.idx;
                    btn.className = `w-full text-left px-3 py-2 rounded-lg text-xs transition ${active ? 'bg-blue-50 text-blue-600 font-bold' : 'text-slate-500 hover:bg-slate-50'}`;
                    btn.innerText = `${i+1}. ${t}`;
                    btn.onclick = () => { this.idx = i; this.render(); this.renderTOC(); if(window.innerWidth < 768) ui.toggleSidebar(); };
                    list.appendChild(btn);
                });
            },
            nav: function(dir) {
                const next = this.idx + dir;
                if (next >= 0 && next <= 10) { this.idx = next; this.render(); this.renderTOC(); }
            }
        };

        const audio = {
            synth: window.speechSynthesis,
            voices: [],
            u: null,
            rate: 1.0,
            init: function() {
                const load = () => { this.voices = this.synth.getVoices(); };
                if (this.synth.onvoiceschanged !== undefined) this.synth.onvoiceschanged = load;
                load();
            },
            toggle: function() {
                if (this.synth.speaking && !this.synth.paused) { this.synth.pause(); this.updateUI(false); }
                else if (this.synth.paused) { this.synth.resume(); this.updateUI(true); }
                else { this.play(); }
            },
            play: function() {
                if (app.lang === 'fa') return;
                this.stop();
                const text = document.getElementById('text-body').innerText.substring(0, 3000);
                this.u = new SpeechSynthesisUtterance(text);
                const target = app.lang === 'tr' ? 'tr' : 'en';
                const v = this.voices.find(v => v.lang.toLowerCase().includes(target));
                if (v) this.u.voice = v;
                this.u.rate = this.rate;
                this.u.onend = () => { this.updateUI(false); document.getElementById('audio-progress').style.width = '100%'; };
                this.u.onboundary = (e) => { 
                    const pct = (e.charIndex / text.length) * 100;
                    document.getElementById('audio-progress').style.width = `${pct}%`; 
                };
                this.synth.speak(this.u);
                this.updateUI(true);
            },
            stop: function() { this.synth.cancel(); this.updateUI(false); document.getElementById('audio-progress').style.width = '0%'; },
            speed: function() {
                const rates = [1, 1.25, 1.5, 0.75];
                this.rate = rates[(rates.indexOf(this.rate) + 1) % rates.length];
                document.getElementById('speed-btn').innerText = this.rate + 'x';
                if (this.synth.speaking) { this.stop(); this.play(); }
            },
            updateUI: function(playing) {
                document.getElementById('play-btn').innerHTML = playing ? '<i class="fas fa-pause"></i>' : '<i class="fas fa-play ml-1"></i>';
                document.getElementById('audio-status').innerText = playing ? "Reading Chapter..." : (this.synth.paused ? "Paused" : "Listen Chapter");
            },
            showWidget: function() { 
                const player = document.getElementById('audio-player');
                player.classList.remove('hidden'); 
                player.style.display = 'flex'; // تضمین نمایش در موبایل
            },
            hide: function() { this.stop(); document.getElementById('audio-player').classList.add('hidden'); }
        };

        const ui = {
            toggleSidebar: function() {
                const s = document.getElementById('sidebar');
                s.classList.toggle('-translate-x-full');
            }
        };

        window.onload = () => app.init();
    </script>
</body>
</html>
